# Configuración básica para Miss Star International
Options -Indexes
ServerSignature Off

# Configurar la codificación de caracteres
AddDefaultCharset UTF-8

# Configurar el manejo de archivos
<IfModule mod_mime.c>
    AddType text/css .css
    AddType text/javascript .js
    AddType application/javascript .js
    AddType image/svg+xml .svg
    AddType image/webp .webp
    AddType font/woff .woff
    AddType font/woff2 .woff2
    AddType image/png .png
    AddType image/x-icon .ico
</IfModule>

# Activar compresión de archivos
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/x-javascript application/json application/xml image/svg+xml
</IfModule>

# Configurar caché del navegador
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType application/x-font-woff "access plus 1 year"
</IfModule>

# Redireccionar a HTTPS si está disponible
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Redireccionar HTTP a HTTPS
    # Descomenta las líneas siguientes cuando tengas SSL instalado
    # RewriteCond %{HTTPS} off
    # RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
    
    # Redirigir a index.html si se solicita un directorio
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^(.+[^/])$ $1/ [R=301,L]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^(.+)/$ $1/index.html [L]
    
    # Manejar redirecciones para directorios de idiomas
    RewriteRule ^(en|es|pt)$ /$1/ [R=301,L]
    
    # Definir página de error 404
    ErrorDocument 404 /404.html
</IfModule>

# Protección adicional
<FilesMatch "(\.htaccess|\.htpasswd|\.git)">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Configuración de seguridad
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Avoid domain errors
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
</IfModule>

# Redirect 404 errors to home page - except for conference pages
ErrorDocument 404 /index.html

# Allow direct access to conference pages
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Don't redirect if the file or directory exists
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]
    
    # Don't redirect conference URLs
    RewriteRule ^(en|es|pt|th|vi)/conference/ - [L]
    
    # For all other 404s, redirect to home page
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.html [L]
</IfModule>

# Browser cache
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresByType image/ico "access plus 1 year"
    ExpiresByType image/icon "access plus 1 year"
    ExpiresByType image/vnd.microsoft.icon "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType text/x-javascript "access plus 1 month"
    ExpiresByType application/x-shockwave-flash "access plus 1 month"
    ExpiresDefault "access plus 2 days"
</IfModule>

# Configurar Cache-Control
<FilesMatch "\.(html|htm)$">
    Header set Cache-Control "max-age=180"
</FilesMatch>

<FilesMatch "\.(jpg|jpeg|png|gif|ico|css|js)$">
    Header set Cache-Control "max-age=31536000"
</FilesMatch>

# Remover headers innecesarios
Header unset X-XSS-Protection
Header unset X-Frame-Options

# Configurar Content Security Policy
Header set Content-Security-Policy "frame-ancestors 'self'"

# Remover Expires header
Header unset Expires 